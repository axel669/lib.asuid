<html>
    <head>
        <title>ASUID</title>
        <meta name="viewport" content="initial-scale=1,maximum-scale=1,minimum-scale=1,width=device-width" />

        <link href="https://cdn.jsdelivr.net/npm/prismjs@v1.29.0/themes/prism-twilight.css" rel="stylesheet" />
        <link href="/style.css" rel="stylesheet" />
    </head>

    <body ws-x="theme[tron]">
        <script src="https://cdn.jsdelivr.net/npm/@axel669/windstorm@0.1.17/dist/browser.js"></script>
        <ws-paper ws-x="r[0px] w[min(100%,800px)] m-l[auto] m-r[auto]">
            <div ws-x="pos[fixed] x[50%] y[0px] grid w[36px] h[40px]
            tr[translateX(max(-400px,-50vw))]">
                <label ws-x="@button @flat $compact $color[primary] r[0px]
                bg[&background-layer] b-s[solid] b-c[&primary]
                b-r-w[2px] b-b-w[2px] b-l-w[2px] r-br[4px] r-bl[4px]"
                for="menu">
                    <ws-icon class="ti-menu-2" ws-x="t-sz[20px]" />
                </label>
            </div>
            <ws-flex ws-x="over[auto] p-x[40px] p-y[0px]" id="wrapper">
                <input type="checkbox" ws-x="hide" id="menu" />
<ws-modal ws-x="&anim-time[200ms]">
    <label for="menu"></label>
    <ws-paper ws-x="@menu r[0px] w[] w-min[20vw] w-max[320px]">
        <ws-flex ws-x="over-y[auto] p-b[16px]">
            <ws-titlebar ws-x="$color[primary]">
                <ws-text ws-x="$title slot[title]">
                    Page Navigation
                </ws-text>
            </ws-titlebar>
            <ws-flex ws-x="p[0px]">
                    <a href="#1-almost-sortable-unique-ids"
                    ws-x="p[8px] p-l[16px] t-sz[&text-size-header]
                    t-deco[none] hover:c[&primary] hover:b-r[3px_solid_var(--primary)]"
                    >
                        Almost Sortable Unique IDs
                    </a>
                    <a href="#1.1-format"
                    ws-x="p[8px] p-l[32px] t-sz[&text-size-header]
                    t-deco[none] hover:c[&primary] hover:b-r[3px_solid_var(--primary)]"
                    >
                        Format
                    </a>
                    <a href="#1.2-installation"
                    ws-x="p[8px] p-l[32px] t-sz[&text-size-header]
                    t-deco[none] hover:c[&primary] hover:b-r[3px_solid_var(--primary)]"
                    >
                        Installation
                    </a>
                    <a href="#1.3-usage"
                    ws-x="p[8px] p-l[32px] t-sz[&text-size-header]
                    t-deco[none] hover:c[&primary] hover:b-r[3px_solid_var(--primary)]"
                    >
                        Usage
                    </a>
                    <a href="#1.3.1-imports"
                    ws-x="p[8px] p-l[48px] t-sz[&text-size-header]
                    t-deco[none] hover:c[&primary] hover:b-r[3px_solid_var(--primary)]"
                    >
                        Imports
                    </a>
                    <a href="#1.3.2-generate"
                    ws-x="p[8px] p-l[48px] t-sz[&text-size-header]
                    t-deco[none] hover:c[&primary] hover:b-r[3px_solid_var(--primary)]"
                    >
                        Generate
                    </a>
                    <a href="#1.3.3-parse"
                    ws-x="p[8px] p-l[48px] t-sz[&text-size-header]
                    t-deco[none] hover:c[&primary] hover:b-r[3px_solid_var(--primary)]"
                    >
                        Parse
                    </a>
            </ws-flex>

            <ws-titlebar ws-x="$color[secondary]">
                <ws-text ws-x="$title slot[title]">
                    Site Navigation
                </ws-text>
            </ws-titlebar>
            <ws-flex ws-x="t-sz[&text-size-header]">
                
    <div>
            <a href="/index.html"
            ws-x="block t-deco[none] hover:c[&secondary]
            hover:b-r[3px_solid_var(--secondary)]">
                
    <ws-icon class="ti-file-text"></ws-icon>


                ASUID
            </a>
        
    </div>

            </ws-flex>
        </ws-flex>
    </ws-paper>
</ws-modal>

                <div>
                    <h1 id="1-almost-sortable-unique-ids">
                <a href="#1-almost-sortable-unique-ids">Almost Sortable Unique IDs</a>
            </h1>
<p>Similar idea to the ksuid, but uses a larger timestamp for millisecond
resolution. Copy-paste friendly, 35 chars long, and lexicographical sorting of
the ids will sort them by time, but if multiple asuids are generated in the
same millisecond (or using the same timestamp) then the random bytes will
prevent ordering them in perfect generated order (hence, almost sortable).</p>
<div class="demo-area"></div>
<script type="module">
    setTimeout(
        async () => {
            const asuid = (await import("https://esm.sh/@axel669/asuid@0.2.1")).default
            const demoArea = document.querySelector(".demo-area")
            demoArea.innerHTML = `
                <button ws-x="@fill $color[primary]">Generate</button>
                <div>Generate an ASUID</div>
            `
            const resultArea = demoArea.querySelector("div")
            demoArea.querySelector("button").addEventListener(
                "click",
                () => resultArea.innerText = asuid()
            )
        }
    )
</script>

<h2 id="1.1-format">
                <a href="#1.1-format">Format</a>
            </h2>
<p><code>| 56 bit timestamp | 120 bit id |</code></p>
<p>The 56 bit timestamp allows for values in the range
[-8640000000000000, 8640000000000000] with millisecond precision. This means
any valid JS date can become a valid asuid, including dates in the past (for
assigning ids to older records).</p>
<h2 id="1.2-installation">
                <a href="#1.2-installation">Installation</a>
            </h2>
<code-area ws-x="pos[relative]">
    <script>
        function test1() {
            navigator.clipboard.writeText(
                "npm add @labyrinthos/asuid"
            )
        }
    </script>
    <pre-header ws-x="pos[absolute] y[0px] -x[0px] z[+10]">
        <button ws-x="@fill $color[primary] $compact p-y[2px]"
        onclick="test1()">
            Copy
        </button>
    </pre-header>
    <pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">add</span> @labyrinthos/asuid</code></pre>
</code-area>
<h2 id="1.3-usage">
                <a href="#1.3-usage">Usage</a>
            </h2>
<h3 id="1.3.1-imports">
                <a href="#1.3.1-imports">Imports</a>
            </h3>
<p>Beacuse this library uses the js cryptography api, there is a different import
for node vs non-node envs.</p>
<code-area ws-x="pos[relative]">
    <script>
        function test2() {
            navigator.clipboard.writeText(
                "// browser/cloudflare workers\nimport asuid from \"@labyrinthos/asuid\"\n// node\nimport asuid from \"@labyrinthos/asuid/node\""
            )
        }
    </script>
    <pre-header ws-x="pos[absolute] y[0px] -x[0px] z[+10]">
        <button ws-x="@fill $color[primary] $compact p-y[2px]"
        onclick="test2()">
            Copy
        </button>
    </pre-header>
    <pre class="language-js"><code class="language-js"><span class="token comment">// browser/cloudflare workers</span>
<span class="token keyword">import</span> asuid <span class="token keyword">from</span> <span class="token string">"@labyrinthos/asuid"</span>
<span class="token comment">// node</span>
<span class="token keyword">import</span> asuid <span class="token keyword">from</span> <span class="token string">"@labyrinthos/asuid/node"</span></code></pre>
</code-area>
<h3 id="1.3.2-generate">
                <a href="#1.3.2-generate">Generate</a>
            </h3>
<code-area ws-x="pos[relative]">
    <script>
        function test3() {
            navigator.clipboard.writeText(
                "//  generate fully random asuid\nasuid()\n\n//  generate random id for a timestamp (or date)\nasuid(timeStamp)\nasuid(new Date(timeStamp))\nasuid(BigInt(timeStamp))\n\n//  generate asuid for current time with set id bytes\nasuid(null, uint8Array)\nasuid(null, idString)\n\n//  regenerate id from parts\nasuid(timeStamp, uint8Array)\nasuid(timeStamp, idString)"
            )
        }
    </script>
    <pre-header ws-x="pos[absolute] y[0px] -x[0px] z[+10]">
        <button ws-x="@fill $color[primary] $compact p-y[2px]"
        onclick="test3()">
            Copy
        </button>
    </pre-header>
    <pre class="language-js"><code class="language-js"><span class="token comment">//  generate fully random asuid</span>
<span class="token function">asuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//  generate random id for a timestamp (or date)</span>
<span class="token function">asuid</span><span class="token punctuation">(</span>timeStamp<span class="token punctuation">)</span>
<span class="token function">asuid</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>timeStamp<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">asuid</span><span class="token punctuation">(</span><span class="token function">BigInt</span><span class="token punctuation">(</span>timeStamp<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">//  generate asuid for current time with set id bytes</span>
<span class="token function">asuid</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> uint8Array<span class="token punctuation">)</span>
<span class="token function">asuid</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> idString<span class="token punctuation">)</span>

<span class="token comment">//  regenerate id from parts</span>
<span class="token function">asuid</span><span class="token punctuation">(</span>timeStamp<span class="token punctuation">,</span> uint8Array<span class="token punctuation">)</span>
<span class="token function">asuid</span><span class="token punctuation">(</span>timeStamp<span class="token punctuation">,</span> idString<span class="token punctuation">)</span></code></pre>
</code-area>
<h3 id="1.3.3-parse">
                <a href="#1.3.3-parse">Parse</a>
            </h3>
<code-area ws-x="pos[relative]">
    <script>
        function test4() {
            navigator.clipboard.writeText(
                "import asuid from \"@labyrinthos/asuid\"\n\nconst parsed = asuid.parse(id)\n{\n    // timestamp for the asuid\n    time\n    // date object from the timestamp\n    date\n    // the id string (last 15 bytes/24 characters)\n    id\n    // the asuid that was parsed\n    source\n}"
            )
        }
    </script>
    <pre-header ws-x="pos[absolute] y[0px] -x[0px] z[+10]">
        <button ws-x="@fill $color[primary] $compact p-y[2px]"
        onclick="test4()">
            Copy
        </button>
    </pre-header>
    <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> asuid <span class="token keyword">from</span> <span class="token string">"@labyrinthos/asuid"</span>

<span class="token keyword">const</span> parsed <span class="token operator">=</span> asuid<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// timestamp for the asuid</span>
    time
    <span class="token comment">// date object from the timestamp</span>
    date
    <span class="token comment">// the id string (last 15 bytes/24 characters)</span>
    id
    <span class="token comment">// the asuid that was parsed</span>
    source
<span class="token punctuation">}</span></code></pre>
</code-area>

                </div>
            </ws-flex>
        </ws-paper>
        <script type="module">
            import mermaid
            from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs"

            mermaid.run({
                querySelector: ".mermaid"
            })
        </script>
    </body>
</html>
